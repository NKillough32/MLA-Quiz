<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Error Test</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .error { color: red; padding: 10px; background: #fee; margin: 5px 0; }
        .success { color: green; padding: 10px; background: #efe; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>JavaScript Error Catcher</h1>
    <div id="output">
        <div class="success">✅ HTML loaded successfully</div>
    </div>
    
    <script>
        // Catch all errors
        window.onerror = function(message, source, lineno, colno, error) {
            const output = document.getElementById('output');
            const div = document.createElement('div');
            div.className = 'error';
            div.innerHTML = `
                <strong>❌ JavaScript Error:</strong><br>
                Message: ${message}<br>
                Source: ${source}<br>
                Line: ${lineno}, Column: ${colno}<br>
                ${error ? 'Stack: ' + error.stack : ''}
            `;
            output.appendChild(div);
            return true;
        };
        
        // Test basic JavaScript
        document.getElementById('output').innerHTML += '<div class="success">✅ Basic JavaScript works</div>';
        
        // Test ES6 module loading
        const testModule = async () => {
            try {
                document.getElementById('output').innerHTML += '<div>Attempting to load V2 main.js...</div>';
                // Add cache buster to force fresh load
                const cacheBuster = '?v=' + Date.now();
                await import('/static/js/v2/main.js' + cacheBuster);
                document.getElementById('output').innerHTML += '<div class="success">✅ V2 main.js loaded</div>';
            } catch (err) {
                const output = document.getElementById('output');
                const div = document.createElement('div');
                div.className = 'error';
                div.innerHTML = `
                    <strong>❌ Module Import Error:</strong><br>
                    ${err.message}<br>
                    ${err.stack || ''}
                `;
                output.appendChild(div);
            }
        };
        
        setTimeout(testModule, 100);
    </script>
</body>
</html>
